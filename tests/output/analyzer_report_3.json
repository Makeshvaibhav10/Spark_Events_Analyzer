{
  "report_metadata": {
    "generated_at": "2025-11-03T12:30:59.488000",
    "report_version": "2.0",
    "analysis_engine": "Spark Event Analyzer - Phase 2",
    "analyzer_capabilities": [
      "Bottleneck Detection",
      "Root Cause Analysis",
      "Failure Detection",
      "Correlation Analysis",
      "Dynamic Thresholding"
    ]
  },
  "executive_summary": {
    "health_score": 79,
    "health_status": "FAIR",
    "total_bottlenecks": 2,
    "critical_bottlenecks": 0,
    "high_priority_bottlenecks": 1,
    "total_anomalies": 0,
    "requires_immediate_action": false,
    "primary_concerns": [
      "GC Overhead / Memory Pressure [HIGH]",
      "CPU Underutilization / CPU Underutilization [MEDIUM]"
    ]
  },
  "performance_metrics": {
    "global": {
      "total_jobs": 0,
      "total_stages": 0,
      "total_tasks": 380,
      "application_duration": "0ms",
      "application_duration_ms": 0
    },
    "task_metrics": {
      "total_tasks": 380,
      "mean_duration_ms": 7470.58,
      "median_duration_ms": 8123.0,
      "std_duration_ms": 2134.87,
      "skew_ratio": 0.286,
      "coefficient_of_variation": 0.286,
      "percentiles": {
        "p25": 4123.0,
        "p50": 8123.0,
        "p75": 8123.0,
        "p90": 10024.0,
        "p95": 10024.0,
        "p99": 10024.0
      },
      "stragglers": {
        "count": 0,
        "percentage": 0.0
      }
    },
    "cpu_metrics": {
      "efficiency": 0.403,
      "efficiency_percentage": "40.29%",
      "wait_percentage": "59.71%",
      "deserialize_overhead_percentage": "0.00%"
    },
    "memory_metrics": {
      "gc_overhead_ratio": 0.225,
      "gc_overhead_percentage": "22.53%",
      "gc_pressure_level": "HIGH",
      "memory_bytes_spilled": 2109734912,
      "memory_spilled_formatted": "1.96 GB",
      "disk_bytes_spilled": 0,
      "total_spilled_formatted": "1.96 GB",
      "tasks_with_spill": 280
    },
    "io_metrics": {
      "input_bytes": 0,
      "input_formatted": "0.00 B",
      "output_bytes": 0,
      "output_formatted": "0.00 B",
      "input_records": 0
    },
    "shuffle_metrics": {
      "shuffle_read_bytes": 0,
      "shuffle_read_formatted": "0.00 B",
      "shuffle_write_bytes": 0,
      "shuffle_write_formatted": "0.00 B",
      "total_shuffle_formatted": "0.00 B",
      "shuffle_time_ms": 0,
      "shuffle_ratio": 0.0,
      "shuffle_ratio_percentage": "0.00%",
      "shuffle_efficiency": 0.0
    },
    "executor_metrics": {
      "total_executors": 1,
      "imbalance_ratio": 0.0,
      "load_imbalance_percentage": 0.0,
      "min_tasks_per_executor": 380,
      "max_tasks_per_executor": 380,
      "mean_tasks_per_executor": 380.0
    },
    "correlations": {
      "gc_vs_duration": 0.9938881941589551,
      "spill_vs_gc": 0.9299828914596215,
      "shuffle_vs_duration": 0.0,
      "cpu_vs_duration": -0.8642732188603169
    }
  },
  "bottlenecks": [
    {
      "bottleneck": "GC Overhead / Memory Pressure",
      "type": "MEMORY",
      "severity": "HIGH",
      "confidence": 0.9210567057786158,
      "impact_score": 0.45057471264367815,
      "metric_evidence": {
        "gc_overhead_ratio": 0.22528735632183908,
        "gc_overhead_percentage": "22.53%",
        "memoryBytesSpilled": 2109734912,
        "memory_spilled_formatted": "1.96 GB",
        "gc_pressure_level": "HIGH",
        "total_gc_time_ms": 137200
      },
      "correlation_evidence": {
        "spill_vs_gc_correlation": 0.9299828914596215,
        "correlation_strength": "STRONG"
      },
      "reasoning": "Probable Cause: Memory pressure due to high garbage collection overhead. Supporting Evidence: GC consumes 22.5% of executor runtime, 1.96 GB spilled to disk (strong correlation: 0.93). Confidence based on GC impact severity and correlation with memory metrics.",
      "impact": "GC consumes 22.5% of executor runtime, causing performance degradation"
    },
    {
      "bottleneck": "CPU Underutilization / CPU Underutilization",
      "type": "CPU",
      "severity": "MEDIUM",
      "confidence": 0.7752755068168913,
      "impact_score": 0.5970935960591133,
      "metric_evidence": {
        "cpu_efficiency": 0.4029064039408867,
        "cpu_utilization_percentage": "40.29%",
        "cpu_wait_percentage": "59.71%",
        "shuffle_ratio": 0.0,
        "deserialize_overhead_percentage": 0.0
      },
      "correlation_evidence": {
        "is_io_bottleneck": false,
        "shuffle_correlation": "LOW"
      },
      "reasoning": "Probable Cause: CPU underutilization with 59.7% CPU idle time. Supporting Evidence: CPU efficiency is 40.3%. Low CPU utilization without I/O pressure suggests serialization overhead or insufficient parallelism.",
      "impact": "CPUs are 59.7% idle, indicating inefficient resource utilization"
    }
  ],
  "anomalies": [],
  "warnings": [],
  "failures": {},
  "root_cause_analysis": [],
  "recommendations": [],
  "action_items": {
    "CRITICAL": [],
    "HIGH": [],
    "MEDIUM": [],
    "LOW": []
  },
  "analysis_metadata": {
    "total_bottlenecks": 2,
    "critical_bottlenecks": 0,
    "high_bottlenecks": 1,
    "total_anomalies": 0
  }
}