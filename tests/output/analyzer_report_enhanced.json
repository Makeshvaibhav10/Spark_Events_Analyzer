{
  "report_metadata": {
    "generated_at": "2025-11-03T18:10:16.831847",
    "report_version": "2.0",
    "analysis_engine": "Spark Event Analyzer - Phase 2",
    "analyzer_capabilities": [
      "Bottleneck Detection",
      "Root Cause Analysis",
      "Failure Detection",
      "Correlation Analysis",
      "Dynamic Thresholding"
    ]
  },
  "executive_summary": {
    "health_score": 80,
    "health_status": "GOOD",
    "total_bottlenecks": 1,
    "critical_bottlenecks": 1,
    "high_priority_bottlenecks": 0,
    "total_anomalies": 0,
    "requires_immediate_action": true,
    "primary_concerns": [
      "DATA_SKEW [CRITICAL]"
    ],
    "total_failures": 1,
    "has_oom_events": false
  },
  "performance_metrics": {
    "global": {
      "total_jobs": 0,
      "total_stages": 3,
      "total_tasks": 10,
      "application_duration": "0ms",
      "application_duration_ms": 0
    },
    "task_metrics": {
      "total_tasks": 10,
      "mean_duration_ms": 995.0,
      "median_duration_ms": 550.0,
      "std_duration_ms": 1164.39,
      "skew_ratio": 1.17,
      "coefficient_of_variation": 0,
      "percentiles": {
        "p50": 550.0,
        "p75": 1325.0,
        "p90": 1749.999999999999,
        "p95": 2874.9999999999973,
        "p99": 3775.0000000000005
      },
      "stragglers": {
        "count": 0,
        "percentage": 0
      }
    },
    "cpu_metrics": {
      "efficiency": 111616161.616,
      "efficiency_percentage": "11161616161.62%",
      "wait_percentage": "-11161616061.62%",
      "deserialize_overhead_percentage": "0.00%"
    },
    "memory_metrics": {
      "gc_overhead_ratio": 0.04,
      "gc_overhead_percentage": "4.04%",
      "gc_pressure_level": "LOW",
      "memory_bytes_spilled": 0,
      "memory_spilled_formatted": "0.00 B",
      "disk_bytes_spilled": 0,
      "total_spilled_formatted": "0.00 B",
      "tasks_with_spill": 0
    },
    "io_metrics": {
      "input_bytes": 0,
      "input_formatted": "0.00 B",
      "output_bytes": 0,
      "output_formatted": "0.00 B",
      "input_records": 0
    },
    "shuffle_metrics": {
      "shuffle_read_bytes": 0,
      "shuffle_read_formatted": "0.00 B",
      "shuffle_write_bytes": 0,
      "shuffle_write_formatted": "0.00 B",
      "total_shuffle_formatted": "0.00 B",
      "shuffle_time_ms": 0,
      "shuffle_ratio": 0,
      "shuffle_ratio_percentage": "0.00%",
      "shuffle_efficiency": 0
    },
    "executor_metrics": {
      "total_executors": 3,
      "imbalance_ratio": 0,
      "load_imbalance_percentage": 0,
      "min_tasks_per_executor": 0,
      "max_tasks_per_executor": 0,
      "mean_tasks_per_executor": 0
    },
    "correlations": {}
  },
  "bottlenecks": [
    {
      "bottleneck": "Data Skew / Partition Imbalance",
      "type": "DATA_SKEW",
      "severity": "CRITICAL",
      "confidence": 0.777242545993627,
      "impact_score": 1.0,
      "metric_evidence": {
        "task_skew_ratio": 1.1702418462407753,
        "coefficient_of_variation": 0,
        "stragglers_count": 0,
        "stragglers_percentage": 0,
        "min_duration_ms": 100.0,
        "median_duration_ms": 550.0,
        "max_duration_ms": 4000.0,
        "p99_duration_ms": 3775.0000000000005
      },
      "reasoning": "Data skew causing uneven partition distribution. Task duration variance is 117.0% of mean, 0.0% of tasks are stragglers. P99 task is 6.9x slower than median. Indicates severe partition imbalance requiring repartitioning.",
      "impact": "Task duration variance is 117.0% of mean, with 0.0% straggler tasks"
    }
  ],
  "anomalies": [],
  "warnings": [],
  "failures": {
    "stage_failures": [],
    "task_failures": [
      {
        "task_id": 14,
        "stage_id": 1,
        "executor_id": "exec-3",
        "failure_type": "FetchFailed",
        "failure_reason": "FetchFailed",
        "task_end_reason": {
          "Reason": "FetchFailed",
          "Message": "Block lost on executor exec-2"
        },
        "timestamp": 1730619001350,
        "duration_ms": 100,
        "metrics_at_failure": {
          "executor_run_time": 0,
          "jvm_gc_time": 0,
          "memory_bytes_spilled": 0,
          "shuffle_read_bytes": 0
        }
      }
    ],
    "executor_failures": [
      {
        "executor_id": "exec-3",
        "failure_type": "UNKNOWN",
        "removed_reason": "Executor lost due to heartbeat timeout",
        "timestamp": 1730619009000,
        "suspected_cause": "Failure of type UNKNOWN. Review logs for details."
      }
    ],
    "oom_events": [],
    "fetch_failures": [
      {
        "task_id": 14,
        "stage_id": 1,
        "executor_id": "exec-3",
        "timestamp": 1730619001350,
        "failure_reason": {
          "Reason": "FetchFailed",
          "Message": "Block lost on executor exec-2"
        },
        "shuffle_metrics": {
          "total_shuffle_bytes": 50811500,
          "total_shuffle_bytes_formatted": "48.46 MB",
          "total_shuffle_time_ms": 1565,
          "total_shuffle_records": 221050,
          "shuffle_time_ratio": 0.15808080808080807,
          "shuffle_time_percentage": 15.808080808080808,
          "tasks_with_shuffle": 6
        },
        "likely_cause": "Network instability or executor failure during shuffle. Check network configuration and executor stability."
      }
    ],
    "summary": {
      "total_stage_failures": 0,
      "total_task_failures": 1,
      "total_executor_failures": 1,
      "total_oom_events": 0,
      "total_fetch_failures": 1,
      "has_critical_failures": false,
      "failure_rate": 2.0
    }
  },
  "root_cause_analysis": [],
  "recommendations": [],
  "action_items": {
    "CRITICAL": [],
    "HIGH": [],
    "MEDIUM": [],
    "LOW": []
  },
  "analysis_metadata": {
    "total_bottlenecks": 1,
    "critical_bottlenecks": 1,
    "high_bottlenecks": 0,
    "total_anomalies": 0
  }
}