# Spark Event Log Analysis Report

**Generated:** 2025-11-01T22:23:28.290193  
**Analyzer Version:** 2.0  

## üìä Executive Summary

### Application Health: **CRITICAL** (35/100)

‚ö†Ô∏è **IMMEDIATE ACTION REQUIRED** - Critical issues detected

- **Total Bottlenecks:** 4
- **Critical Issues:** 1
- **High Priority Issues:** 3
- **Anomalies Detected:** 1

**Primary Concerns:**
- Memory Spill to Disk [CRITICAL]
- GC Overhead / Memory Pressure [HIGH]
- Data Skew / Partition Imbalance [HIGH]

## üìà Performance Metrics

### Application Overview

| Metric | Value |
|--------|-------|
| Total Jobs | 4 |
| Total Stages | 4 |
| Total Tasks | 4 |
| Total Duration | 2m 0s |

### Key Performance Indicators

| KPI | Value | Status |
|-----|-------|--------|
| CPU Efficiency | 36.03% | üî¥ Poor |
| GC Overhead | 24.18% | üî¥ Poor |
| Shuffle Efficiency | 1.000 | ‚úÖ Good |
| Memory Spilled | 1.52 GB | üî¥ High |

## üîç Identified Bottlenecks (4)

### 1. üî¥ Memory Spill to Disk

**Severity:** CRITICAL  
**Confidence:** 100%  
**Type:** MEMORY  
**Impact:** 1.52 GB spilled to disk (71.8% of input data)  

**Analysis:**  
Probable Cause: Insufficient executor memory causing data spill. Supporting Evidence: 1.52 GB spilled to memory, 1.25 GB spilled to disk (71.8% of input data). Indicates memory pressure requiring increased executor memory allocation.

**Evidence:**
- `memoryBytesSpilled`: 1637456281
- `memory_spilled_formatted`: 1.52 GB
- `diskBytesSpilled`: 1342177280
- `disk_spilled_formatted`: 1.25 GB
- `spill_ratio`: 0.7176470585605678
- `spill_percentage`: 71.76%
- `tasks_with_spill`: 3

### 2. üü† GC Overhead / Memory Pressure

**Severity:** HIGH  
**Confidence:** 94%  
**Type:** MEMORY  
**Impact:** GC consumes 24.2% of executor runtime, causing performance degradation  

**Analysis:**  
Probable Cause: Memory pressure due to high garbage collection overhead. Supporting Evidence: GC consumes 24.2% of executor runtime, 1.52 GB spilled to disk (strong correlation: 0.99). Confidence based on GC impact severity and correlation with memory metrics.

**Evidence:**
- `gc_overhead_ratio`: 0.24178082191780823
- `gc_overhead_percentage`: 24.18%
- `memoryBytesSpilled`: 1637456281
- `memory_spilled_formatted`: 1.52 GB
- `gc_pressure_level`: HIGH
- `total_gc_time_ms`: 17650

### 3. üü† Data Skew / Partition Imbalance

**Severity:** HIGH  
**Confidence:** 90%  
**Type:** DATA_SKEW  
**Impact:** Task duration variance is 91.3% of mean, with 0.0% straggler tasks  

**Analysis:**  
Probable Cause: Data skew causing uneven partition distribution. Supporting Evidence: Task duration variance is 91.3% of mean, 0.0% of tasks are stragglers. P99 task is 1.9x slower than median. Indicates severe partition imbalance requiring repartitioning.

**Evidence:**
- `task_skew_ratio`: 0.9129223184735645
- `coefficient_of_variation`: 0.9129223184735645
- `stragglers_count`: 0
- `stragglers_percentage`: 0.0
- `min_duration_ms`: 2000.0
- `median_duration_ms`: 18000.0
- `max_duration_ms`: 35000.0
- `p99_duration_ms`: 34850.0

### 4. üü† CPU Underutilization / CPU Underutilization

**Severity:** HIGH  
**Confidence:** 80%  
**Type:** CPU  
**Impact:** CPUs are 64.0% idle, indicating inefficient resource utilization  

**Analysis:**  
Probable Cause: CPU underutilization with 64.0% CPU idle time. Supporting Evidence: CPU efficiency is 36.0%. Low CPU utilization without I/O pressure suggests serialization overhead or insufficient parallelism.

**Evidence:**
- `cpu_efficiency`: 0.36027397260273974
- `cpu_utilization_percentage`: 36.03%
- `cpu_wait_percentage`: 63.97%
- `shuffle_ratio`: 0.0
- `deserialize_overhead_percentage`: 0.0

## üéØ Root Cause Analysis (1)

### 1. Insufficient Memory / Memory Spill

**Severity:** CRITICAL  
**Confidence:** 100%  

**Recommendation:**  
CRITICAL: 1.52 GB spilled to disk (71.8% of data). Increase executor memory by at least 50% immediately.

**Supporting Metrics:**
- `memory_spilled_bytes`: 1637456281
- `memory_spilled_formatted`: 1.52 GB
- `spill_ratio_percentage`: 71.76%
- `impact`: 1.52 GB spilled to disk (71.8% of input data)

## ‚úÖ Recommended Actions

### üî¥ CRITICAL Priority

- **Insufficient Memory / Memory Spill:** Increase executor memory: spark.executor.memory
- **Insufficient Memory / Memory Spill:** Adjust memory overhead: spark.executor.memoryOverhead
- **Insufficient Memory / Memory Spill:** Tune off-heap memory: spark.memory.offHeap.enabled=true
- **Insufficient Memory / Memory Spill:** Reduce shuffle partition size to fit in memory
- **Insufficient Memory / Memory Spill:** Consider external shuffle service
- **Insufficient Memory / Memory Spill:** Review sorting and aggregation operations

## ‚ö†Ô∏è Failure Analysis

- **Stage Failures:** 2
- **Task Failures:** 0
- **Executor Failures:** 1
- **OOM Events:** 0
- **Fetch Failures:** 0

---

*Report generated by Spark Event Analyzer - Phase 2*
